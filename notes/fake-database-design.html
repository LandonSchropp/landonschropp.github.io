<!DOCTYPE html><html lang="en-us" class="h-full text-[19px] md:text-[21px] lg:text-[22px]"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/052c8b13a035a85d.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/5aabacac4a7bcbc4.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/b7bdc2d4d4aa6554.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/9cad1c3a621a47c7.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/34f92507e61baad2.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-c955a7fd519a96e8.js"/><script src="/_next/static/chunks/72517ffc-002b5c99645a8b93.js" async=""></script><script src="/_next/static/chunks/57-cb55d9a153904b49.js" async=""></script><script src="/_next/static/chunks/main-app-d0c1a7b1af5f9b42.js" async=""></script><script src="/_next/static/chunks/app/not-found-3b40ae5007a7550b.js" async=""></script><script src="/_next/static/chunks/914-aacd263bacfcbd7c.js" async=""></script><script src="/_next/static/chunks/app/notes/layout-93f8d22dc8a588b9.js" async=""></script><script src="/_next/static/chunks/867-34944a4304bcfa99.js" async=""></script><script src="/_next/static/chunks/app/notes/%5Bslug%5D/page-964d695cc4a264ba.js" async=""></script><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"/><link rel="shortcut icon" type="image/png" href="/_next/static/media/flannel.5168cfc2.png"/><title>Landon Schropp – How to Fake a Database Design</title><meta name="description" content="Landon Schropp&#x27;s notes about How to Fake a Database Design"/><meta name="author" content="Landon Schropp"/><link href="https://fonts.googleapis.com/css2?family=Gentium+Book+Plus:ital,wght@0,400;0,700;1,400;1,700&amp;family=Open+Sans:ital,wght@0,400;0,700;0,800;1,400;1,700;1,800&amp;family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&amp;display=swap" rel="stylesheet"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="flex h-full flex-col bg-theme-background font-serif font-normal text-theme-text *:flex-[0_0_auto]"><nav class="my-3 flex gap-3 px-2 text-sm text-theme-extraLightText lg:justify-between max-lg:flex-col"><div class="flex justify-center"><a class="mx-2 block text-inherit transition-all duration-75 ease-in font-sans text-theme-lightText  " href="/"><span class="max-md:hidden">Landon Schropp</span><span class="md:hidden">Home</span></a><a class="mx-2 block text-inherit transition-all duration-75 ease-in font-sans text-theme-lightText  " href="/articles">Writing</a><a class="mx-2 block text-inherit transition-all duration-75 ease-in font-sans text-theme-lightText  " href="/notes">Notes</a><a class="mx-2 block text-inherit transition-all duration-75 ease-in font-sans text-theme-lightText  " href="/today-i-learned"><abbr class="no-underline lg:hidden" title="Today I Learned">TIL</abbr><span class="max-lg:hidden">Today I Learned</span></a></div><div class="flex justify-center"><a class="mx-2 block text-inherit transition-all duration-75 ease-in hocus:text-theme-accent " href="https://github.com/LandonSchropp"><svg viewBox="0 0 96 92" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="inline-block h-3.6 w-3.6 fill-[currentColor] align-middle undefined" title="GitHub"><title>github</title><g fill-rule="evenodd"><path d="M32.5603088,74.0782655 C32.5603088,74.4587393 32.1227638,74.7631185 31.5710767,74.7631185 C30.9432948,74.8201895 30.5057498,74.5158104 30.5057498,74.0782655 C30.5057498,73.6977916 30.9432948,73.3934125 31.4949819,73.3934125 C32.0656927,73.3363414 32.5603088,73.6407205 32.5603088,74.0782655 Z M26.6439399,73.2221992 C26.510774,73.6026731 26.8912479,74.0402181 27.4619587,74.1543602 C27.9565748,74.3445972 28.5272856,74.1543602 28.6414278,73.7738864 C28.7555699,73.3934125 28.3941197,72.9558675 27.8234089,72.7846543 C27.3287929,72.6514884 26.7771057,72.8417253 26.6439399,73.2221992 Z M35.0524127,72.8987964 C34.5007256,73.0319623 34.1202517,73.3934125 34.1773228,73.8309574 C34.2343939,74.2114313 34.7290099,74.4587393 35.2997208,74.3255735 C35.8514079,74.1924076 36.2318818,73.8309574 36.1748107,73.4504836 C36.1177396,73.0890334 35.6040999,72.8417253 35.0524127,72.8987964 Z M47.5700036,4.26325641e-14 C21.1841396,4.26325641e-14 1,20.0319501 1,46.417814 C1,67.5150909 14.2785386,85.5685768 33.2451618,91.9224907 C35.6801946,92.3600356 36.5362609,90.8571638 36.5362609,89.6206237 C36.5362609,88.4411546 36.4791898,81.9350512 36.4791898,77.9400754 C36.4791898,77.9400754 23.1626038,80.7936295 20.3661208,72.2710145 C20.3661208,72.2710145 18.1974196,66.7351195 15.0775338,65.3083424 C15.0775338,65.3083424 10.7211078,62.3216224 15.3819129,62.3786935 C15.3819129,62.3786935 20.1188127,62.7591674 22.7250588,67.2868066 C26.8912479,74.6299526 33.8729437,72.5183225 36.593332,71.2627587 C37.0308769,68.2189676 38.2674171,66.1073376 39.637123,64.8517737 C29.002878,63.6723047 18.2735144,62.1313855 18.2735144,43.8305916 C18.2735144,38.5990757 19.7193152,35.9738059 22.7631062,32.6256357 C22.2684902,31.3890955 20.6514762,26.2907455 23.2577223,19.7085473 C27.2336744,18.4720071 36.3840713,24.8449447 36.3840713,24.8449447 C40.1888102,23.7796178 44.2789044,23.2279307 48.3309513,23.2279307 C52.3829982,23.2279307 56.4730925,23.7796178 60.2778313,24.8449447 C60.2778313,24.8449447 69.4282283,18.4529834 73.4041804,19.7085473 C76.0104265,26.3097692 74.3934125,31.3890955 73.8987964,32.6256357 C76.9425875,35.9928295 78.8069095,38.6180994 78.8069095,43.8305916 C78.8069095,62.1884565 67.6019536,63.653281 56.9677085,64.8517737 C58.7178884,66.3546456 60.2017365,69.2081997 60.2017365,73.6787679 C60.2017365,80.0897528 60.1446655,88.0226334 60.1446655,89.5825763 C60.1446655,90.8191164 61.0197554,92.3219883 63.4357646,91.8844433 C82.4594588,85.5685768 95.3575235,67.5150909 95.3575235,46.417814 C95.3575235,20.0319501 73.9558675,4.26325641e-14 47.5700036,4.26325641e-14 Z M19.4910308,65.6127215 C19.2437228,65.8029585 19.3007939,66.2405034 19.6241967,66.6019536 C19.9285758,66.9063327 20.3661208,67.0394986 20.6134288,66.7921906 C20.8607368,66.6019536 20.8036657,66.1644086 20.4802629,65.8029585 C20.1758838,65.4985793 19.7383388,65.3654135 19.4910308,65.6127215 Z M17.4364718,64.0718023 C17.303306,64.3191103 17.4935429,64.6234894 17.8740168,64.8137264 C18.1783959,65.0039633 18.5588698,64.9468922 18.6920357,64.6805605 C18.8252015,64.4332525 18.6349646,64.1288734 18.2544907,63.9386364 C17.8740168,63.8244943 17.5696377,63.8815653 17.4364718,64.0718023 Z M23.6001488,70.8442374 C23.2957697,71.0915455 23.4099118,71.6622563 23.8474568,72.0237065 C24.2850018,72.4612514 24.8366889,72.5183225 25.0839969,72.2139434 C25.331305,71.9666354 25.2171628,71.3959246 24.8366889,71.0344744 C24.4181676,70.5969294 23.8474568,70.5398583 23.6001488,70.8442374 Z M21.4314476,68.0477544 C21.1270685,68.2379913 21.1270685,68.7326074 21.4314476,69.1701523 C21.7358267,69.6076973 22.2494665,69.7979343 22.4967745,69.6076973 C22.8011536,69.3603893 22.8011536,68.8657732 22.4967745,68.4282283 C22.2304428,67.9906833 21.7358267,67.8004464 21.4314476,68.0477544 Z" fill-rule="nonzero"></path></g></svg></a><a class="mx-2 block text-inherit transition-all duration-75 ease-in hocus:text-theme-accent " href="https://www.chess.com/member/landon"><svg viewBox="0 0 66 94" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="inline-block h-3.6 w-3.6 fill-[currentColor] align-middle undefined" title="Chess.com"><title>chess-com</title><g fill-rule="evenodd"><path d="M32.8765515,0.000347033209 C34.9673608,0.000347033209 36.942014,0.397080995 38.7424332,1.1332201 L38.5975603,1.07322462 C38.6288206,1.06552778 38.6577775,1.06656311 38.6843551,1.07659402 C44.3760027,3.34163743 48.3833872,8.77774162 48.3833872,15.1198632 C48.3833872,20.1595848 45.8279536,24.5764194 41.9367251,27.3510976 L53.1457861,34.5426104 C53.1457861,36.9775321 52.5650058,38.902819 51.403445,40.9979842 L41.5301789,40.9979842 C41.762491,45.3015666 39.9620719,55.7207663 56.165844,67.7821225 C61.8574916,72.0290789 65.1679396,79.1639657 65.1679396,87.8843828 C65.1679396,88.2807654 64.2967691,94 32.8765515,94 C1.45633391,94 0.585163362,88.2807654 0.585163362,87.8843828 C0.585163362,84.3169394 1.16594372,80.9760004 2.15327034,78.0314439 C2.19172015,77.9233039 2.24293522,77.8235346 2.30629326,77.731637 C3.84342918,73.6488124 6.30250442,70.2374765 9.58725897,67.7821225 C22.0015813,58.5678434 23.862702,50.2985066 24.1393809,44.9959711 C24.117374,44.8770176 24.106768,44.7519288 24.106768,44.6220536 C24.106768,43.1497754 24.106768,41.9606276 24.1648461,40.9979842 L14.2915799,40.9979842 C13.1300192,38.902819 12.5492388,36.9775321 12.5492388,34.5426104 L23.7582998,27.2944715 C19.8670714,24.5764194 17.3116378,20.1029587 17.3116378,15.0632371 C17.3116378,6.73920255 24.2810021,-0.0559276875 32.8765515,0.000347033209 Z" fill-rule="nonzero"></path></g></svg></a><a class="mx-2 block text-inherit transition-all duration-75 ease-in hocus:text-theme-accent " href="https://www.linkedin.com/in/landonschropp"><svg viewBox="0 0 79 78" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="inline-block h-3.6 w-3.6 fill-[currentColor] align-middle undefined" title="LinkedIn"><title>linked-in</title><g fill-rule="evenodd"><path d="M72.4540496,0 L5.57949606,0 C2.51521034,0 0.0254781979,2.52455357 0.0254781979,5.62366071 L0.0254781979,72.3763393 C0.0254781979,75.4754464 2.51521034,78 5.57949606,78 L72.4540496,78 C75.5183353,78 78.0254782,75.4754464 78.0254782,72.3763393 L78.0254782,5.62366071 C78.0254782,2.52455357 75.5183353,0 72.4540496,0 Z M23.5995853,66.8571429 L12.0388711,66.8571429 L12.0388711,29.6330357 L23.6169961,29.6330357 L23.6169961,66.8571429 L23.5995853,66.8571429 Z M17.8192282,24.5491071 C14.1107461,24.5491071 11.1161032,21.5370536 11.1161032,17.8459821 C11.1161032,14.1549107 14.1107461,11.1428571 17.8192282,11.1428571 C21.5102996,11.1428571 24.5223532,14.1549107 24.5223532,17.8459821 C24.5223532,21.5544643 21.5277103,24.5491071 17.8192282,24.5491071 L17.8192282,24.5491071 Z M66.9348532,66.8571429 L55.3741389,66.8571429 L55.3741389,48.75 C55.3741389,44.4321429 55.2870853,38.878125 49.3674425,38.878125 C43.3433353,38.878125 42.4205675,43.5790179 42.4205675,48.4366071 L42.4205675,66.8571429 L30.8598532,66.8571429 L30.8598532,29.6330357 L41.9504782,29.6330357 L41.9504782,34.7169643 L42.1071746,34.7169643 C43.6567282,31.7919643 47.4348532,28.7102679 53.0585139,28.7102679 C64.7585139,28.7102679 66.9348532,36.4232143 66.9348532,46.4517857 L66.9348532,66.8571429 L66.9348532,66.8571429 Z" fill-rule="nonzero"></path></g></svg></a><a class="mx-2 block text-inherit transition-all duration-75 ease-in hocus:text-theme-accent " href="mailto:schroppl@gmail.com"><svg viewBox="0 0 89 66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="inline-block h-3.6 w-3.6 fill-[currentColor] align-middle undefined" title="Email"><title>email</title><g fill-rule="evenodd"><path d="M9.13301677,0 C4.57832927,0 0.883016771,3.6953125 0.883016771,8.25 C0.883016771,10.8453125 2.10332927,13.2859375 4.18301677,14.85 L41.5830168,42.9 C43.5423918,44.3609375 46.2236418,44.3609375 48.1830168,42.9 L85.5830168,14.85 C87.6627043,13.2859375 88.8830168,10.8453125 88.8830168,8.25 C88.8830168,3.6953125 85.1877043,0 80.6330168,0 L9.13301677,0 Z M0.883016771,19.25 L0.883016771,55 C0.883016771,61.0671875 5.81582927,66 11.8830168,66 L77.8830168,66 C83.9502043,66 88.8830168,61.0671875 88.8830168,55 L88.8830168,19.25 L51.4830168,47.3 C47.5642668,50.2390625 42.2017668,50.2390625 38.2830168,47.3 L0.883016771,19.25 Z" fill-rule="nonzero"></path></g></svg></a></div></nav><main class="mx-auto w-[70ch] max-w-full px-2 md:px-4"><!--$--><article class="my-6" data-category="Development"><header class="my-6 text-center"><h1 class="my-0"><span class="block mx-auto my-1 m-width[50ch] text-base font-normal font-serif italic text-theme-lightText [&amp;_a]:underline">My personal notes for</span> <span class="block"><a class="no-underline hover:underline" href="https://www.youtube.com/watch?v=y1tcbhWLiUM">How to Fake a Database Design</a></span></h1><div class="my-2 block mx-auto my-1 m-width[50ch] text-base font-normal font-serif italic text-theme-lightText [&amp;_a]:underline" data-test-id="sub-text">A talk by <!-- -->Curtis Poe<!-- --> from <!-- -->YAPC Eurpoe 2014</div><div class="mb-2 mt-3 text-sm text-theme-accent"><a href="/notes?category=Development" class="
    inline-block rounded-full border-none bg-theme-accent px-2 py-0.75 font-sans text-xs
    font-normal uppercase tracking-wider text-white no-underline transition-shadow duration-75
    ease-in hocus:shadow-outline hocus:shadow-theme-accent/50 selected:shadow-outline
    selected:shadow-theme-accent/50 md:text-2xs
  " data-technology="Development">Development</a></div></header><section><p>Developers are generally bad at database design, even when they are great at SQL.</p>
<p>What does it mean to have a well-designed database?</p>
<ul>
<li><em>Generally normalized</em></li>
<li>Denormalized only as necessary</li>
<li>No data is duplicated</li>
</ul>
<h2>Rules for Designing Good Databases</h2>
<ol>
<li>
<p><strong>Nouns == tables.</strong> A good place to start is by building your tables out from the nouns in the domain.</p>
<p>When determining if a noun should be a column within another table or a table by itself, consider if that noun belongs to that table. In other words, does the noun make sense when separated from the rest of the table? For example, it wouldn’t make sense to separate a <code>name</code> column from a <code>people</code> table because the name is completely tied to the person. However, it may make sense to separate an <code>address</code> column from a <code>customers</code> table if the address can be considered in other contexts.</p>
</li>
<li>
<p><strong>Use foreign key constraints.</strong> If one table uses an ID from another table, it must use a foreign key constraint. These constraints help to maintain <em>referential integrity</em>, which prevents bad references. If you don’t use foreign key constraints, your data will inevitably end up inconsistent.</p>
</li>
<li>
<p><strong>Lists of things get their own table.</strong> You can loosely define a list as something that can have zero, one or many elements (with exceptions).</p>
</li>
<li>
<p><strong>Many-to-many relationships should use a lookup table.</strong> These relationships should use foreign key constraints.</p>
</li>
<li>
<p><strong>Equality ≠ Identity.</strong> When we say no duplication, we mean not duplicating the <em>identity</em> of two things. It’s completely possible for two records to share the same data but to be unique instances. For example, you could have two records in a <code>people</code> table that both have the name <code>John Smith</code> but still represent unique individuals.</p>
<p>This rule can be summed up as: <em>watch for equal values that aren’t identical.</em></p>
</li>
<li>
<p><strong>Name columns as descriptively as possible.</strong> Names are very important in databases. Names should hint at their use. You should carefully consider the names of things. <em>In a well-designed database, it should be hard to insert bad data.</em></p>
<p>He doesn’t like <code>id</code> columns. He’d prefer <code>&lt;table&gt;_id</code>. I think this makes sense when you’re writing raw SQL, but it’s better to stick to the framework conventions when using an ORM.</p>
</li>
<li>
<p><strong>Avoid <code>null</code> values.</strong> Curtis defines <code>null</code> as an unknown value and claims we shouldn’t use them most of the time.</p>
<p>The first point I disagree with is his definition of <code>null</code>. The common definition of <code>null</code> is not unknown—it’s <em>nothing</em>.</p>
<p>I’m on the fence about this point. On one hand, he points out several situations where I think it’s good to avoid <code>null</code> values:</p>
<ul>
<li>When <code>null</code> is used to represent an unknown value, then I agree with his point. In those cases, it definitely makes sense to avoid them.
This is distinct from when <code>null</code> is used to represent “nothing,” which is a perfectly valid time to use <code>null</code>.
When <code>null</code> is being used in place of another value as a special case, then two columns are probably more appropriate, or switching to an <code>enum</code> in the case of a flag. For example, using <code>null</code> to represent a one-time event in a <code>frequency</code> integer column might be tempting, but that’s not the same as “nothing.”</li>
<li>Rather than using <code>null</code> to indicate something is missing, it might be better to break those values out into a separate table. This applies especially when multiple columns, such as in an address, are tied together. In these cases, the existence or non-existence of a record is a better indicator if something has an address.</li>
</ul>
<p>Curtis also lists query complexity as a reason for avoiding <code>null</code>, but with an ORM like Rails, that complexity is abstracted away, so it’s not a concern.</p>
<p>Finally, using other values, such as an empty string, to represent “nothing” is an anti-pattern. In these cases, you’re creating a “magic value” that’s not clear from the type of your column, which comes with its own downsides.</p>
</li>
</ol>
<h2>Jargon</h2>
<p>Curtis mentions several terms during his talk. While his talk isn’t about formal terminology, I thought it might still be helpful to note down some of the definitions.</p>
<ul>
<li>
<p><strong>Normalization:</strong> “[The] process of structuring a database, usually a relational database, in accordance with a series of so-called normal forms, in order to reduce data redundancy and improve data integrity.” (<a href="https://en.wikipedia.org/wiki/Database_normalization">Wikipedia</a>) This idea was first proposed by Edgar F. Codd as part of his relational model. <em>A database is typically said to be normalized if it meets the third normal form (3NF).</em></p>
</li>
<li>
<p><strong>Normal forms:</strong> These are a hierarchy of rules that can be applied to databases. Each rule adds a new constraint.</p>
<p><img src="fake-database-design/normal-forms.png" alt="A table of the normal forms from Wikipedia"></p>
</li>
<li>
<p><strong>Data integrity:</strong> &quot;Data integrity is the overall accuracy, completeness, and consistency of data. Data integrity also refers to the safety of data in regard to regulatory compliance — such as GDPR compliance — and security. It is maintained by a collection of processes, rules, and standards implemented during the design phase.” (<a href="https://www.qlik.com/us/data-management/data-integrity">Qlik</a>)</p>
</li>
<li>
<p><strong>Data definition language (DDL):</strong> “A syntax for creating and modifying database objects such as tables, indices, and users” (<a href="https://en.wikipedia.org/wiki/Data_definition_language">Wikipedia</a>)</p>
</li>
<li>
<p><strong>Surrogate key:</strong> An artificially generated key that uniquely identifies a row. This key should have no semantic relationships with the data in the record. An example might be a UUID. The primary advantage of using surrogate keys is that the identifier is insulated from changes to the data.</p>
</li>
<li>
<p><strong>Natural key:</strong> A unique key tied to the data in a record. An example might be a zip code acting as a primary key to identify a mail delivery zone. These are also called <em>business keys</em> or <em>domain keys.</em></p>
</li>
<li>
<p><strong>Referential integrity:</strong> All of the references (via foreign keys) are valid. This ensures non-existent references can’t be created or updated and that records can’t be deleted while referenced elsewhere.</p>
</li>
</ul>
</section></article><!--/$--></main><script src="/_next/static/chunks/webpack-c955a7fd519a96e8.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"6:\"$Sreact.fragment\"\n7:I[7556,[],\"\"]\n8:I[8418,[],\"\"]\n9:I[9306,[\"345\",\"static/chunks/app/not-found-3b40ae5007a7550b.js\"],\"default\"]\nb:I[1406,[\"914\",\"static/chunks/914-aacd263bacfcbd7c.js\",\"763\",\"static/chunks/app/notes/layout-93f8d22dc8a588b9.js\"],\"MainNavigation\"]\nc:\"$Sreact.suspense\"\ne:I[5277,[],\"OutletBoundary\"]\n10:I[5277,[],\"MetadataBoundary\"]\n12:I[5277,[],\"ViewportBoundary\"]\n14:I[6379,[],\"\"]\n1:HL[\"/_next/static/css/052c8b13a035a85d.css\",\"style\"]\n2:HL[\"/_next/static/css/5aabacac4a7bcbc4.css\",\"style\"]\n3:HL[\"/_next/static/css/b7bdc2d4d4aa6554.css\",\"style\"]\n4:HL[\"/_next/static/css/9cad1c3a621a47c7.css\",\"style\"]\n5:HL[\"/_next/static/css/34f92507e61baad2.css\",\"style\"]\na:T5e1,M219.572308,442 L219.572308,372.487514 L243,372.487514 L243,299.237798 L219.572308,299.237798 L219.572308,3 L82.9938462,3 L0,303.971623 L0,372.487514 L130.098462,372.487514 L130.098462,442 L219.572308,442 Z M130,300 L78,300 L130,79 L130,300 Z M373,446 C410.173104,446 438.799714,435.629836 458.879828,414.889509 C478.959943,394.149182 489,364.28311 489,325.291295 L489,325.291295 L489,127.677455 C489,86.5286458 479.457797,54.9618676 460.373391,32.9771205 C441.288984,10.9923735 412.164521,0 373,0 C334.001431,0 304.918455,10.9923735 285.751073,32.9771205 C266.583691,54.9618676 257,86.5286458 257,127.677455 L257,127.677455 L257,325.291295 C257,364.28311 267.081545,394.149182 287.244635,414.889509 C307.407725,435.629836 335.992847,446 373,446 Z M372.5,365 C365.909962,365 360.679119,361.927448 356.807471,355.782343 C352.935824,349.637238 351,342.744755 351,335.104895 L351,335.104895 L351,118.61451 C351,108.317308 352.112069,99.3072552 354.336207,91.5843531 C356.560345,83.861451 362.614943,80 372.5,80 C382.385057,80 388.439655,83.861451 390.663793,91.5843531 C392.887931,99.3072552 394,108.317308 394,118.61451 L394,118.61451 L394,335.104895 C394,342.744755 392.105364,349.637238 388.316092,355.782343 C384.52682,361.927448 379.254789,365 372.5,365 Z M722.572308,442 L722.572308,372.487514 L746,372.487514 L746,299.237798 L722.572308,299.237798 L722.572308,3 L"])</script><script>self.__next_f.push([1,"585.993846,3 L503,303.971623 L503,372.487514 L633.098462,372.487514 L633.098462,442 L722.572308,442 Z M633,300 L581,300 L633,79 L633,300 Z"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"8E8wb3EEWDi4TQkkDoJVo\",\"p\":\"\",\"c\":[\"\",\"notes\",\"fake-database-design\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"notes\",{\"children\":[[\"slug\",\"fake-database-design\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$6\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/052c8b13a035a85d.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en-us\",\"className\":\"h-full text-[19px] md:text-[21px] lg:text-[22px]\",\"children\":[[\"$\",\"head\",null,{\"children\":[[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.googleapis.com\"}],[\"$\",\"link\",null,{\"rel\":\"preconnect\",\"href\":\"https://fonts.gstatic.com\",\"crossOrigin\":\"anonymous\"}],[\"$\",\"link\",null,{\"href\":\"https://fonts.googleapis.com/css2?family=Gentium+Book+Plus:ital,wght@0,400;0,700;1,400;1,700\u0026family=Open+Sans:ital,wght@0,400;0,700;0,800;1,400;1,700;1,800\u0026family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700\u0026display=swap\",\"rel\":\"stylesheet\"}],[\"$\",\"link\",null,{\"rel\":\"shortcut icon\",\"type\":\"image/png\",\"href\":\"/_next/static/media/flannel.5168cfc2.png\"}]]}],[\"$\",\"body\",null,{\"className\":\"flex h-full flex-col bg-theme-background font-serif font-normal text-theme-text *:flex-[0_0_auto]\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"$L9\",null,{\"viewBox\":\"0 0 746 446\",\"title\":\"404\",\"children\":[[\"$\",\"rect\",null,{\"x\":0,\"y\":0,\"width\":746,\"height\":446,\"fill\":\"transparent\"}],[\"$\",\"path\",null,{\"className\":\"fill-[url('#svg-data-background')]\",\"id\":\"not-found\",\"d\":\"$a\"}]]}],\"notFoundStyles\":[]}]}]]}]]}],{\"children\":[\"notes\",[\"$\",\"$6\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/5aabacac4a7bcbc4.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/b7bdc2d4d4aa6554.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/9cad1c3a621a47c7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"3\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/34f92507e61baad2.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[[\"$\",\"$Lb\",null,{}],[\"$\",\"main\",null,{\"className\":\"mx-auto w-[70ch] max-w-full px-2 md:px-4\",\"children\":[\"$\",\"$c\",null,{\"children\":[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"notes\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]}]}]]]}],{\"children\":[[\"slug\",\"fake-database-design\",\"d\"],[\"$\",\"$6\",\"c\",{\"children\":[null,[\"$\",\"$L7\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"notes\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L8\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$6\",\"c\",{\"children\":[\"$Ld\",null,[\"$\",\"$Le\",null,{\"children\":\"$Lf\"}]]}],{},null]},null]},null]},null],[\"$\",\"$6\",\"h\",{\"children\":[null,[\"$\",\"$6\",\"pc2tYAg4KFdNtB_dsnUfS\",{\"children\":[[\"$\",\"$L10\",null,{\"children\":\"$L11\"}],[\"$\",\"$L12\",null,{\"children\":\"$L13\"}],null]}]]}]]],\"m\":\"$undefined\",\"G\":[\"$14\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"13:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"15:I[5677,[\"867\",\"static/chunks/867-34944a4304bcfa99.js\",\"740\",\"static/chunks/app/notes/%5Bslug%5D/page-964d695cc4a264ba.js\"],\"Note\"]\n16:T1808,"])</script><script>self.__next_f.push([1,"Developers are generally bad at database design, even when they are great at SQL.\n\nWhat does it mean to have a well-designed database?\n\n- _Generally normalized_\n- Denormalized only as necessary\n- No data is duplicated\n\n## Rules for Designing Good Databases\n\n1. **Nouns == tables.** A good place to start is by building your tables out from the nouns in the domain.\n\n   When determining if a noun should be a column within another table or a table by itself, consider if that noun belongs to that table. In other words, does the noun make sense when separated from the rest of the table? For example, it wouldn’t make sense to separate a `name` column from a `people` table because the name is completely tied to the person. However, it may make sense to separate an `address` column from a `customers` table if the address can be considered in other contexts.\n\n2. **Use foreign key constraints.** If one table uses an ID from another table, it must use a foreign key constraint. These constraints help to maintain _referential integrity_, which prevents bad references. If you don’t use foreign key constraints, your data will inevitably end up inconsistent.\n3. **Lists of things get their own table.** You can loosely define a list as something that can have zero, one or many elements (with exceptions).\n4. **Many-to-many relationships should use a lookup table.** These relationships should use foreign key constraints.\n5. **Equality ≠ Identity.** When we say no duplication, we mean not duplicating the _identity_ of two things. It’s completely possible for two records to share the same data but to be unique instances. For example, you could have two records in a `people` table that both have the name `John Smith` but still represent unique individuals.\n\n   This rule can be summed up as: _watch for equal values that aren’t identical._\n\n6. **Name columns as descriptively as possible.** Names are very important in databases. Names should hint at their use. You should carefully consider the names of things. _In a well-designed database, it should be hard to insert bad data._\n\n   He doesn’t like `id` columns. He’d prefer `\u003ctable\u003e_id`. I think this makes sense when you’re writing raw SQL, but it’s better to stick to the framework conventions when using an ORM.\n\n7. **Avoid `null` values.** Curtis defines `null` as an unknown value and claims we shouldn’t use them most of the time.\n\n   The first point I disagree with is his definition of `null`. The common definition of `null` is not unknown—it’s _nothing_.\n\n   I’m on the fence about this point. On one hand, he points out several situations where I think it’s good to avoid `null` values:\n\n   - When `null` is used to represent an unknown value, then I agree with his point. In those cases, it definitely makes sense to avoid them.\n     This is distinct from when `null` is used to represent “nothing,” which is a perfectly valid time to use `null`.\n     When `null` is being used in place of another value as a special case, then two columns are probably more appropriate, or switching to an `enum` in the case of a flag. For example, using `null` to represent a one-time event in a `frequency` integer column might be tempting, but that’s not the same as “nothing.”\n   - Rather than using `null` to indicate something is missing, it might be better to break those values out into a separate table. This applies especially when multiple columns, such as in an address, are tied together. In these cases, the existence or non-existence of a record is a better indicator if something has an address.\n\n   Curtis also lists query complexity as a reason for avoiding `null`, but with an ORM like Rails, that complexity is abstracted away, so it’s not a concern.\n\n   Finally, using other values, such as an empty string, to represent “nothing” is an anti-pattern. In these cases, you’re creating a “magic value” that’s not clear from the type of your column, which comes with its own downsides.\n\n## Jargon\n\nCurtis mentions several terms during his talk. While his talk isn’t about formal terminology, I thought it might still be helpful to note down some of the definitions.\n\n- **Normalization:** “[The] process of structuring a database, usually a relational database, in accordance with a series of so-called normal forms, in order to reduce data redundancy and improve data integrity.” ([Wikipedia](https://en.wikipedia.org/wiki/Database_normalization)) This idea was first proposed by Edgar F. Codd as part of his relational model. _A database is typically said to be normalized if it meets the third normal form (3NF)._\n- **Normal forms:** These are a hierarchy of rules that can be applied to databases. Each rule adds a new constraint.\n\n  ![A table of the normal forms from Wikipedia](normal-forms.png)\n\n- **Data integrity:** \"Data integrity is the overall accuracy, completeness, and consistency of data. Data integrity also refers to the safety of data in regard to regulatory compliance — such as GDPR compliance — and security. It is maintained by a collection of processes, rules, and standards implemented during the design phase.” ([Qlik](https://www.qlik.com/us/data-management/data-integrity))\n- **Data definition language (DDL):** “A syntax for creating and modifying database objects such as tables, indices, and users” ([Wikipedia](https://en.wikipedia.org/wiki/Data_definition_language))\n- **Surrogate key:** An artificially generated key that uniquely identifies a row. This key should have no semantic relationships with the data in the record. An example might be a UUID. The primary advantage of using surrogate keys is that the identifier is insulated from changes to the data.\n- **Natural key:** A unique key tied to the data in a record. An example might be a zip code acting as a primary key to identify a mail delivery zone. These are also called _business keys_ or _domain keys._\n- **Referential integrity:** All of the references (via foreign keys) are valid. This ensures non-existent references can’t be created or updated and that records can’t be deleted while referenced elsewhere."])</script><script>self.__next_f.push([1,"d:[\"$\",\"$L15\",null,{\"note\":{\"title\":\"How to Fake a Database Design\",\"slug\":\"fake-database-design\",\"date\":\"2022-02-06\",\"published\":true,\"markdown\":\"$16\",\"filePath\":\"/Users/landon/Notes/Resources/Notes/Development/How to Fake a Database Design/How to Fake a Database Design.md\",\"authors\":[\"Curtis Poe\"],\"category\":\"Development\",\"media\":\"Recorded Talk\",\"url\":\"https://www.youtube.com/watch?v=y1tcbhWLiUM\",\"source\":\"YAPC Eurpoe 2014\"}}]\n11:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"Landon Schropp – How to Fake a Database Design\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Landon Schropp's notes about How to Fake a Database Design\"}],[\"$\",\"meta\",\"3\",{\"name\":\"author\",\"content\":\"Landon Schropp\"}]]\nf:null\n"])</script></body></html>